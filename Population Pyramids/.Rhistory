#Set working directory
setwd("C:/Users/daily/Desktop/Repositories/MiscVisuals/Population Pyramids")
#Load necessary libraries
library(tidyverse)
library(ggplot2)
library(ggthemes)
#Import data
career_data <- read.csv("C:/Users/daily/Desktop/Repositories/MiscVisuals/Population Pyramids/MLB Single Season WAR.csv")
#Create WAR breakdown groups
career_data <- career_data %>%
mutate(WARGroup = ifelse(WAR < 1, "Less Than 1 WAR Season",
ifelse(WAR < 2, "1 to 2 WAR Season",
ifelse(WAR < 3, "2 to 3 WAR Season",
ifelse(WAR < 4, "3 to 4 WAR Season",
ifelse(WAR < 5, "4 to 5 WAR Season",
ifelse(WAR < 6, "5 to 6 WAR Season",
ifelse(WAR < 7, "6 to 7 WAR Season",
ifelse(WAR < 8, "7 to 8 WAR Season",
ifelse(WAR < 9, "8 to 9 WAR Season",
ifelse(WAR < 10, "9 to 10 WAR Season, 10 or More WAR Season")))))))))))
View(career_data)
career_data <- career_data %>%
mutate(WARGroup = ifelse(WAR < 1, "Less Than 1 WAR Season",
ifelse(WAR < 2, "1 to 2 WAR Season",
ifelse(WAR < 3, "2 to 3 WAR Season",
ifelse(WAR < 4, "3 to 4 WAR Season",
ifelse(WAR < 5, "4 to 5 WAR Season",
ifelse(WAR < 6, "5 to 6 WAR Season",
ifelse(WAR < 7, "6 to 7 WAR Season",
ifelse(WAR < 8, "7 to 8 WAR Season",
ifelse(WAR < 9, "8 to 9 WAR Season",
ifelse(WAR < 10, "9 to 10 WAR Season", "10 or More WAR Season")))))))))))
View(career_data)
data_for_graph <- career_data %>%
group_by(WARGroup, Position) %>%
count(WARGroup) %>%
ungroup()
View(data_for_graph)
data_for_graph <- data_for_graph %>%
mutate(n = ifelse(Position == "Pitchers", -1 * n, n))
View(data_for_graph)
ordered_WARGroup <- factor(data_for_graph$WARGroup, levels = c("Less Than 1 WAR Season",
"1 to 2 WAR Season",
"2 to 3 WAR Season",
"3 to 4 WAR Season",
"4 to 5 WAR Season",
"5 to 6 WAR Season",
"6 to 7 WAR Season",
"7 to 8 WAR Season",
"8 to 9 WAR Season",
"9 to 10 WAR Season",
"10 or More WAR Season"))
data_for_graph %>%
ggplot(aes(x = ordered_WARGroup, y = n, fill = Position)) +
geom_bar(stat = "identity") +
scale_y_continuous(breaks = seq(-40000, 40000, 5000),
labels = c(seq(-40000, 0, -5000), seq(5000, 40000, 5000))) +
coord_flip() +
theme_tufte() +
scale_fill_brewer(palette = "Set1") +
labs(title = "Single Season WAR Pyramid",
x = "WAR Group",
y = "Number of Player Seasons") +
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank())
data_for_graph %>%
ggplot(aes(x = ordered_WARGroup, y = n, fill = Position)) +
geom_bar(stat = "identity") +
scale_y_continuous(breaks = seq(-40000, 40000, 5000),
labels = c(seq(40000, 0, -5000), seq(5000, 40000, 5000))) +
coord_flip() +
theme_tufte() +
scale_fill_brewer(palette = "Set1") +
labs(title = "Single Season WAR Pyramid",
x = "WAR Group",
y = "Number of Player Seasons") +
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank())
career_data <- career_data %>%
mutate(WARGroup = ifelse(WAR < 0, "Less Than 0 WAR Season",
ifelse(WAR < 1, "0 to 1 WAR Season",
ifelse(WAR < 2, "1 to 2 WAR Season",
ifelse(WAR < 3, "2 to 3 WAR Season",
ifelse(WAR < 4, "3 to 4 WAR Season",
ifelse(WAR < 5, "4 to 5 WAR Season",
ifelse(WAR < 6, "5 to 6 WAR Season",
ifelse(WAR < 7, "6 to 7 WAR Season",
ifelse(WAR < 8, "7 to 8 WAR Season",
ifelse(WAR < 9, "8 to 9 WAR Season",
ifelse(WAR < 10, "9 to 10 WAR Season", "10 or More WAR Season"))))))))))))
#Get count of values for each group
data_for_graph <- career_data %>%
group_by(WARGroup, Position) %>%
count(WARGroup) %>%
ungroup()
#Create negative count for pitchers
data_for_graph <- data_for_graph %>%
mutate(n = ifelse(Position == "Pitchers", -1 * n, n))
#Ordering position for visual
ordered_WARGroup <- factor(data_for_graph$WARGroup, levels = c("Less Than 0 WAR Season",
"0 to 1 WAR Season",
"1 to 2 WAR Season",
"2 to 3 WAR Season",
"3 to 4 WAR Season",
"4 to 5 WAR Season",
"5 to 6 WAR Season",
"6 to 7 WAR Season",
"7 to 8 WAR Season",
"8 to 9 WAR Season",
"9 to 10 WAR Season",
"10 or More WAR Season"))
data_for_graph %>%
ggplot(aes(x = ordered_WARGroup, y = n, fill = Position)) +
geom_bar(stat = "identity") +
scale_y_continuous(breaks = seq(-20000, 20000, 5000),
labels = c(seq(20000, 0, -5000), seq(5000, 20000, 5000))) +
coord_flip() +
theme_tufte() +
scale_fill_brewer(palette = "Set1") +
labs(title = "Single Season WAR Pyramid",
x = "WAR Group",
y = "Number of Player Seasons") +
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank())
data_for_graph <- career_data %>%
group_by(WARGroup, Position) %>%
count(WARGroup) %>%
ungroup()
#Create negative count for pitchers
data_for_graph <- data_for_graph %>%
mutate(n = ifelse(Position == "Pitchers", -1 * n, n))
#Ordering position for visual
ordered_WARGroup <- factor(data_for_graph$WARGroup, levels = c("Less Than 0 WAR Season",
"0 to 0.5 WAR Season",
"0.5 to 1 WAR Season",
"1 to 2 WAR Season",
"2 to 3 WAR Season",
"3 to 4 WAR Season",
"4 to 5 WAR Season",
"5 to 6 WAR Season",
"6 to 7 WAR Season",
"7 to 8 WAR Season",
"8 to 9 WAR Season",
"9 to 10 WAR Season",
"10 or More WAR Season"))
career_data <- career_data %>%
mutate(WARGroup = ifelse(WAR < 0, "Less Than 0 WAR Season",
ifelse(WAR < .5, "0 to 0.5 WAR Season",
ifelse(WAR < 1, "0.5 to 1 WAR Season",
ifelse(WAR < 2, "1 to 2 WAR Season",
ifelse(WAR < 3, "2 to 3 WAR Season",
ifelse(WAR < 4, "3 to 4 WAR Season",
ifelse(WAR < 5, "4 to 5 WAR Season",
ifelse(WAR < 6, "5 to 6 WAR Season",
ifelse(WAR < 7, "6 to 7 WAR Season",
ifelse(WAR < 8, "7 to 8 WAR Season",
ifelse(WAR < 9, "8 to 9 WAR Season",
ifelse(WAR < 10, "9 to 10 WAR Season", "10 or More WAR Season")))))))))))))
#Get count of values for each group
data_for_graph <- career_data %>%
group_by(WARGroup, Position) %>%
count(WARGroup) %>%
ungroup()
#Create negative count for pitchers
data_for_graph <- data_for_graph %>%
mutate(n = ifelse(Position == "Pitchers", -1 * n, n))
#Ordering position for visual
ordered_WARGroup <- factor(data_for_graph$WARGroup, levels = c("Less Than 0 WAR Season",
"0 to 0.5 WAR Season",
"0.5 to 1 WAR Season",
"1 to 2 WAR Season",
"2 to 3 WAR Season",
"3 to 4 WAR Season",
"4 to 5 WAR Season",
"5 to 6 WAR Season",
"6 to 7 WAR Season",
"7 to 8 WAR Season",
"8 to 9 WAR Season",
"9 to 10 WAR Season",
"10 or More WAR Season"))
#Create visual
data_for_graph %>%
ggplot(aes(x = ordered_WARGroup, y = n, fill = Position)) +
geom_bar(stat = "identity") +
scale_y_continuous(breaks = seq(-20000, 20000, 5000),
labels = c(seq(20000, 0, -5000), seq(5000, 20000, 5000))) +
coord_flip() +
theme_tufte() +
scale_fill_brewer(palette = "Set1") +
labs(title = "Single Season WAR Pyramid",
x = "WAR Group",
y = "Number of Player Seasons") +
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank())
career_data <- career_data %>%
mutate(WARGroup = ifelse(WAR < 0, "Below Replacement Season",
ifelse(WAR < .5, "0 to 0.5 WAR Season",
ifelse(WAR < 1, "0.5 to 1 WAR Season",
ifelse(WAR < 1.5, "1 to 1.5 WAR Season",
ifelse(WAR < 2, "1.5 to 2 WAR Season",
ifelse(WAR < 2.5, "2 to 2.5 WAR Season",
ifelse(WAR < 3, "2.5 to 3 WAR Season",
ifelse(WAR < 3.5, "3 to 3.5 WAR Season",
ifelse(WAR < 4, "3.5 to 4 WAR Season",
ifelse(WAR < 4.5, "4 to 4.5 WAR Season",
ifelse(WAR < 5, "4.5 to 5 WAR Season", "5 or More WAR Season"))))))))))))
data_for_graph <- career_data %>%
group_by(WARGroup, Position) %>%
count(WARGroup) %>%
ungroup()
data_for_graph <- data_for_graph %>%
mutate(n = ifelse(Position == "Pitchers", -1 * n, n))
#Set working directory
setwd("C:/Users/daily/Desktop/Repositories/MiscVisuals/Population Pyramids")
#Load necessary libraries
library(tidyverse)
library(ggplot2)
library(ggthemes)
#Import data
career_data <- read.csv("C:/Users/daily/Desktop/Repositories/MiscVisuals/Population Pyramids/MLB Single Season WAR.csv")
#Create WAR breakdown groups
career_data <- career_data %>%
mutate(WARGroup = ifelse(WAR < 0, "Below Replacement Season",
ifelse(WAR < .5, "0 to 0.5 WAR Season",
ifelse(WAR < 1, "0.5 to 1 WAR Season",
ifelse(WAR < 1.5, "1 to 1.5 WAR Season",
ifelse(WAR < 2, "1.5 to 2 WAR Season",
ifelse(WAR < 2.5, "2 to 2.5 WAR Season",
ifelse(WAR < 3, "2.5 to 3 WAR Season",
ifelse(WAR < 3.5, "3 to 3.5 WAR Season",
ifelse(WAR < 4, "3.5 to 4 WAR Season",
ifelse(WAR < 4.5, "4 to 4.5 WAR Season",
ifelse(WAR < 5, "4.5 to 5 WAR Season", "5 or More WAR Season"))))))))))))
#Get count of values for each group
data_for_graph <- career_data %>%
group_by(WARGroup, Position) %>%
count(WARGroup) %>%
ungroup()
#Create negative count for pitchers
data_for_graph <- data_for_graph %>%
mutate(n = ifelse(Position == "Pitchers", -1 * n, n))
#Ordering position for visual
ordered_WARGroup <- factor(data_for_graph$WARGroup, levels = c("Below Replacement Season",
"0 to 0.5 WAR Season",
"0.5 to 1 WAR Season",
"1 to 1.5 WAR Season",
"1.5 to 2 WAR Season",
"2 to 2.5 WAR Season",
"2.5 to 3 WAR Season",
"3 to 3.5 WAR Season",
"3.5 to 4 WAR Season",
"4 to 4.5 WAR Season",
"4.5 to 5 WAR Season",
"5 or More WAR Season"))
data_for_graph %>%
ggplot(aes(x = ordered_WARGroup, y = n, fill = Position)) +
geom_bar(stat = "identity") +
scale_y_continuous(breaks = seq(-20000, 20000, 5000),
labels = c(seq(20000, 0, -5000), seq(5000, 20000, 5000))) +
coord_flip() +
theme_tufte() +
scale_fill_brewer(palette = "Set1") +
labs(title = "Modern Era Single Season WAR Pyramid",
x = "WAR Group",
y = "Number of Player Seasons") +
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank())
career_data <- career_data %>%
mutate(WARGroup = ifelse(WAR < 0, "Below Replacement Season",
ifelse(WAR < .5, "0 to 0.5 WAR Season",
ifelse(WAR < 1, "0.5 to 1 WAR Season",
ifelse(WAR < 1.5, "1 to 1.5 WAR Season",
ifelse(WAR < 2, "1.5 to 2 WAR Season",
ifelse(WAR < 2.5, "2 to 2.5 WAR Season",
ifelse(WAR < 3, "2.5 to 3 WAR Season",
ifelse(WAR < 3.5, "3 to 3.5 WAR Season",
ifelse(WAR < 4, "3.5 to 4 WAR Season",
ifelse(WAR < 4.5, "4 to 4.5 WAR Season",
ifelse(WAR < 5, "4.5 to 5 WAR Season",
ifelse(WAR < 5.5, "5 to 5.5 WAR Season",
ifelse(WAR < 6, "5.5 to 6 WAR Season","6 or More WAR Season")))))))))))))
#Get count of values for each group
data_for_graph <- career_data %>%
group_by(WARGroup, Position) %>%
count(WARGroup) %>%
ungroup()
#Create negative count for pitchers
data_for_graph <- data_for_graph %>%
mutate(n = ifelse(Position == "Pitchers", -1 * n, n))
#Ordering position for visual
ordered_WARGroup <- factor(data_for_graph$WARGroup, levels = c("Below Replacement Season",
"0 to 0.5 WAR Season",
"0.5 to 1 WAR Season",
"1 to 1.5 WAR Season",
"1.5 to 2 WAR Season",
"2 to 2.5 WAR Season",
"2.5 to 3 WAR Season",
"3 to 3.5 WAR Season",
"3.5 to 4 WAR Season",
"4 to 4.5 WAR Season",
"4.5 to 5 WAR Season",
"5 to 5.5 WAR Season",
"5.5 to 6 WAR Season",
"6 or More WAR Season"))
#Create visual
#Set working directory
setwd("C:/Users/daily/Desktop/Repositories/MiscVisuals/Population Pyramids")
#Load necessary libraries
library(tidyverse)
library(ggplot2)
library(ggthemes)
#Import data
career_data <- read.csv("C:/Users/daily/Desktop/Repositories/MiscVisuals/Population Pyramids/MLB Single Season WAR.csv")
#Create WAR breakdown groups
career_data <- career_data %>%
mutate(WARGroup = ifelse(WAR < 0, "Below Replacement Season",
ifelse(WAR < .5, "0 to 0.5 WAR Season",
ifelse(WAR < 1, "0.5 to 1 WAR Season",
ifelse(WAR < 1.5, "1 to 1.5 WAR Season",
ifelse(WAR < 2, "1.5 to 2 WAR Season",
ifelse(WAR < 2.5, "2 to 2.5 WAR Season",
ifelse(WAR < 3, "2.5 to 3 WAR Season",
ifelse(WAR < 3.5, "3 to 3.5 WAR Season",
ifelse(WAR < 4, "3.5 to 4 WAR Season",
ifelse(WAR < 4.5, "4 to 4.5 WAR Season",
ifelse(WAR < 5, "4.5 to 5 WAR Season",
ifelse(WAR < 5.5, "5 to 5.5 WAR Season",
ifelse(WAR < 6, "5.5 to 6 WAR Season","6 or More WAR Season")))))))))))))
)
#Set working directory
setwd("C:/Users/daily/Desktop/Repositories/MiscVisuals/Population Pyramids")
#Load necessary libraries
library(tidyverse)
library(ggplot2)
library(ggthemes)
#Import data
career_data <- read.csv("C:/Users/daily/Desktop/Repositories/MiscVisuals/Population Pyramids/MLB Single Season WAR.csv")
#Create WAR breakdown groups
career_data <- career_data %>%
mutate(WARGroup = ifelse(WAR < 0, "Below Replacement Season",
ifelse(WAR < .5, "0 to 0.5 WAR Season",
ifelse(WAR < 1, "0.5 to 1 WAR Season",
ifelse(WAR < 1.5, "1 to 1.5 WAR Season",
ifelse(WAR < 2, "1.5 to 2 WAR Season",
ifelse(WAR < 2.5, "2 to 2.5 WAR Season",
ifelse(WAR < 3, "2.5 to 3 WAR Season",
ifelse(WAR < 3.5, "3 to 3.5 WAR Season",
ifelse(WAR < 4, "3.5 to 4 WAR Season",
ifelse(WAR < 4.5, "4 to 4.5 WAR Season",
ifelse(WAR < 5, "4.5 to 5 WAR Season",
ifelse(WAR < 5.5, "5 to 5.5 WAR Season",
ifelse(WAR < 6, "5.5 to 6 WAR Season","6 or More WAR Season"))))))))))))))
View(career_data)
#Get count of values for each group
data_for_graph <- career_data %>%
group_by(WARGroup, Position) %>%
count(WARGroup) %>%
ungroup()
#Create negative count for pitchers
data_for_graph <- data_for_graph %>%
mutate(n = ifelse(Position == "Pitchers", -1 * n, n))
#Ordering position for visual
ordered_WARGroup <- factor(data_for_graph$WARGroup, levels = c("Below Replacement Season",
"0 to 0.5 WAR Season",
"0.5 to 1 WAR Season",
"1 to 1.5 WAR Season",
"1.5 to 2 WAR Season",
"2 to 2.5 WAR Season",
"2.5 to 3 WAR Season",
"3 to 3.5 WAR Season",
"3.5 to 4 WAR Season",
"4 to 4.5 WAR Season",
"4.5 to 5 WAR Season",
"5 to 5.5 WAR Season",
"5.5 to 6 WAR Season",
"6 or More WAR Season"))
View(data_for_graph)
data_for_graph %>%
ggplot(aes(x = ordered_WARGroup, y = n, fill = Position)) +
geom_bar(stat = "identity") +
scale_y_continuous(breaks = seq(-20000, 20000, 5000),
labels = c(seq(20000, 0, -5000), seq(5000, 20000, 5000))) +
coord_flip() +
theme_tufte() +
scale_fill_brewer(palette = "Set1") +
labs(title = "Modern Era Single Season WAR Pyramid",
x = "WAR Group",
y = "Number of Player Seasons") +
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank())
#Set working directory
setwd("C:/Users/daily/Desktop/Repositories/MiscVisuals/Population Pyramids")
#Load necessary libraries
library(tidyverse)
library(ggplot2)
library(ggthemes)
#Import data
career_data <- read.csv("C:/Users/daily/Desktop/Repositories/MiscVisuals/Population Pyramids/MLB Career WAR.csv")
#Create WAR breakdown groups
career_data <- career_data %>%
mutate(WARGroup = ifelse(WAR < 1, "Less Than 1 WAR",
ifelse(WAR < 5, "1 to 5 WAR",
ifelse(WAR < 10, "5 to 10 WAR",
ifelse(WAR < 20, "10 to 20 WAR",
ifelse(WAR < 30, "20 to 30 WAR",
ifelse(WAR < 40, "30 to 40 WAR",
ifelse(WAR < 50, "40 to 50 WAR",
ifelse(WAR < 60, "50 to 60 WAR", "60 or More WAR")))))))))
#Get count of values for each group
data_for_graph <- career_data %>%
group_by(WARGroup, Position) %>%
count(WARGroup) %>%
ungroup()
#Create negative count for pitchers
data_for_graph <- data_for_graph %>%
mutate(n = ifelse(Position == "Pitchers", -1 * n, n))
#Ordering position for visual
ordered_WARGroup <- factor(data_for_graph$WARGroup, levels = c("Less Than 1 WAR",
"1 to 5 WAR",
"5 to 10 WAR",
"10 to 20 WAR",
"20 to 30 WAR",
"30 to 40 WAR",
"40 to 50 WAR",
"50 to 60 WAR",
"60 or More WAR"))
#Create visual
data_for_graph %>%
ggplot(aes(x = ordered_WARGroup, y = n, fill = Position)) +
geom_bar(stat = "identity") +
scale_y_continuous(breaks = seq(-7000, 7000, 1000),
labels = c(seq(7000, 0, -1000), seq(1000, 7000, 1000))) +
coord_flip() +
theme_tufte() +
scale_fill_brewer(palette = "Set1") +
labs(title = "Career WAR of Major Leaguers",
x = "WAR Group",
y = "Number of Players") +
theme(plot.title = element_text(hjust = .5),
axis.ticks = element_blank())
